process {
    withName: SRATOOLS_FASTERQDUMP {
        ext.args = { [ "--outdir", "\${PWD}" ].join(" ") }
    }
    withName: FASTP {
        publishDir = 
                [
                    path: { "${params.outdir}/${meta.id}/FastqFiltered" },
                    mode: params.publish_dir_mode,
                    pattern: "*.{json,html,log,fastq.gz}",
                    saveAs: { filename -> filename.equals('versions.yml') ? null : filename }
                ]
        ext.args = { ["-q", "20", "-l", "45", "--dont_eval_duplication", "--trim_poly_g", "--trim_poly_x"].join(" ") }
        container = "quay.io/biocontainers/fastp:0.23.4--h5f740d0_0"
    }
    withName: RNA_SPADES {
        ext.args = { ["--rna"].join(" ") }
        container = "quay.io/biocontainers/spades:4.0.0--h5fb382e_1"
        ext.prefix = { "rna_${meta.id}" }
    }
    withName: META_SPADES {
        ext.args = { ["--meta"].join(" ") }
        container = "quay.io/biocontainers/spades:4.0.0--h5fb382e_1"
        ext.prefix = { "meta_${meta.id}" }
    }
    withName: CORONA_SPADES {
        ext.args = { ["--corona"].join(" ") }
        container = "quay.io/biocontainers/spades:4.0.0--h5fb382e_1"
        ext.prefix = { "corona_${meta.id}" }
    }
    withName: SPADES {
        container = "quay.io/biocontainers/spades:4.0.0--h5fb382e_1"
        ext.prefix = { "spades_${meta.id}" }
    }
    withName: TRINITY {
        container = "quay.io/biocontainers/trinity:2.15.2--pl5321hdcf5f25_1"
        ext.prefix = { "trinity_${meta.id}" }
    }
    withName: CDHIT_CDHITEST {
        container = "quay.io/biocontainers/cd-hit:4.8.1--h5b5514e_7"
        ext.args = { ["-aS", "0.9", "-g", "1", "-n", "9"].join(" ") }
    }
    withName: SEQTK_SEQ {
        container = "quay.io/biocontainers/seqtk:1.4--he4a0461_1"
        ext.args = { ["-L", ${params.minsize}].join(" ") }
    }
    

}
